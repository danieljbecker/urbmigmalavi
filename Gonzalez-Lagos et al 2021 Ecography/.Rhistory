mot=-10 ## motus
tvm=-round((4.5*2*300)/1000,0) ## taylor pcr
iso=-round((13.5*100)/1000,0) ## dero iso
dna=-round((600*8)/1000,0) ## extractions
lmeta=-20 ## lauren chapter 2
lmeta2=-abs(lmeta*2) ## lauren belize
ma23=0 ## meagan fall 2023 covered DARPA
ll23=-round(3*gra/1000,0) ## lauren 2 month spring and all summer and fall 23 on DARPA
lab=-10 ## random stuff
sq=-(4.5*2*500)/1000 ## sanger
bz25=-10.5
phood=-4
ee=-(2350-1500)/1000
## gain back from Match
ovmatch=13657/1000
## adjust match by ecoimm reagents
ovmatch=ovmatch-2.5
## nsf charges
cryo=(2988)/1000
## adjust for other proteomic reagents
cryo=cryo+5
## all commitments
total+sum(c(bz23,kd24,tv24,tvm,iso,dna,lmeta,lmeta2,ma23,ll23,sq,bz25,phood,ee,lab,pt,mot))+ovmatch+cryo
## random and tvm covered by BII and Scialog, iso from IU/JFF
total+
sum(bz23,kd24,tv24,dna,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,pt,mot,sq)+ovmatch+cryo
64-(gra*12/1000)
## DNA possibly covered by IU/other
total+
sum(bz23,kd24,tv24,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,pt,mot,sq)+ovmatch+cryo
total
sum(bz23,kd24,tv24,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,sq)
## all commitments
total+sum(c(bz23,kd24,tv24,tvm,iso,dna,lmeta,lmeta2,ma23,ll23,sq,bz25,phood,ee,lab,pt,mot))+ovmatch+cryo
## random and tvm covered by BII and Scialog, iso from IU/JFF
total+
sum(bz23,kd24,tv24,dna,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,pt,mot,sq)+ovmatch+cryo
## DNA possibly covered by IU/other
total+
sum(bz23,kd24,tv24,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,pt,mot,sq)+ovmatch+cryo
## if Powe, JFF, DISC come through
total+
sum(bz23,kd24,tv24,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,sq)+ovmatch+cryo
81-(gra*12/1000)
## all commitments
total+sum(c(bz23,kd24,tv24,tvm,iso,dna,lmeta,lmeta2,ma23,ll23,sq,bz25,phood,ee,lab,pt,mot))+ovmatch+cryo
## startup as of 02 2023
total=183
bz23=-4 ## remaining Belize 2023
kd24=-round(3*gra/1000,0) ## kristin covered Fall 2023 through Summer 2024, Fall 2024 3 months needed / 2 covered
tv24=-round(5*gra/1000,0) ## taylor 2024
pt=-4.4 ## pit tag cables
mot=-10 ## motus
tvm=-round((4.5*2*300)/1000,0) ## taylor pcr
iso=-round((13.5*100)/1000,0) ## dero iso
dna=-round((600*8)/1000,0) ## extractions
lmeta=-20 ## lauren chapter 2
lmeta2=-abs(lmeta*2) ## lauren belize
ma23=0 ## meagan fall 2023 covered DARPA
ll23=-round(3*gra/1000,0) ## lauren 2 month spring and all summer and fall 23 on DARPA
lab=-10 ## random stuff
sq=-(4.5*2*500)/1000 ## sanger
bz25=-10.5
phood=-4
ee=-(2350-1500)/1000
## gain back from Match
ovmatch=13657/1000
## adjust match by ecoimm reagents
ovmatch=ovmatch-2.5
## nsf charges
cryo=(2988)/1000
## adjust for other proteomic reagents
cryo=cryo+5
## all commitments
total+sum(c(bz23,kd24,tv24,tvm,iso,dna,lmeta,lmeta2,ma23,ll23,sq,bz25,phood,ee,lab,pt,mot))+ovmatch+cryo
gra*12
gra
## clean environment & plots
rm(list=ls())
graphics.off()
## GRA
gra=3363
## startup as of 02 2023
total=183
bz23=-4 ## remaining Belize 2023
kd24=-round(3*gra/1000,0) ## kristin covered Fall 2023 through Summer 2024, Fall 2024 3 months needed / 2 covered
tv24=-round(5*gra/1000,0) ## taylor 2024
pt=-4.4 ## pit tag cables
mot=-10 ## motus
tvm=-round((4.5*2*300)/1000,0) ## taylor pcr
iso=-round((13.5*100)/1000,0) ## dero iso
dna=-round((600*8)/1000,0) ## extractions
lmeta=-20 ## lauren chapter 2
lmeta2=-abs(lmeta*2) ## lauren belize
ma23=0 ## meagan fall 2023 covered DARPA
ll23=-round(3*gra/1000,0) ## lauren 2 month spring and all summer and fall 23 on DARPA
lab=-10 ## random stuff
sq=-(4.5*2*500)/1000 ## sanger
bz25=-10.5
phood=-4
ee=-(2350-1500)/1000
## gain back from Match
ovmatch=13657/1000
## adjust match by ecoimm reagents
ovmatch=ovmatch-2.5
## nsf charges
cryo=(2988)/1000
## adjust for other proteomic reagents
cryo=cryo+5
## all commitments
total+sum(c(bz23,kd24,tv24,tvm,iso,dna,lmeta,lmeta2,ma23,ll23,sq,bz25,phood,ee,lab,pt,mot))+ovmatch+cryo
## all commitments
total+sum(c(bz23,kd24,tv24,tvm,iso,dna,lmeta,lmeta2,ma23,ll23,sq,bz25,phood,ee,lab,pt,mot))+ovmatch+cryo-(gra*12/1000)
## random and tvm covered by BII and Scialog, iso from IU/JFF
total+
sum(bz23,kd24,tv24,dna,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,pt,mot,sq)+ovmatch+cryo
## random and tvm covered by BII and Scialog, iso from IU/JFF
total+
sum(bz23,kd24,tv24,dna,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,pt,mot,sq)+ovmatch+cryo-(gra*12/1000)
25+35
gamma=1/3
beta=0.01
gamma/beta
gamma/0.1
gamma/1
185*10
## clean environment & plots
rm(list=ls())
graphics.off()
## GRA
gra=3363
## startup as of 02 2023
total=183
bz23=-4 ## remaining Belize 2023
kd24=-round(3*gra/1000,0) ## kristin covered Fall 2023 through Summer 2024, Fall 2024 3 months needed / 2 covered
tv24=-round(5*gra/1000,0) ## taylor 2024
pt=-4.4 ## pit tag cables
mot=-10 ## motus
tvm=-round((4.5*2*300)/1000,0) ## taylor pcr
iso=-round((13.5*100)/1000,0) ## dero iso
dna=-round((600*8)/1000,0) ## extractions
lmeta=-20 ## lauren chapter 2
lmeta2=-abs(lmeta*2) ## lauren belize
ma23=0 ## meagan fall 2023 covered DARPA
ll23=-round(3*gra/1000,0) ## lauren 2 month spring and all summer and fall 23 on DARPA
lab=-10 ## random stuff
sq=-(4.5*2*500)/1000 ## sanger
bz25=-10.5
phood=-4
ee=-(2350-1500)/1000
tele=2
## gain back from Match
ovmatch=13657/1000
## adjust match by ecoimm reagents
ovmatch=ovmatch-2.5
## nsf charges
cryo=(2988)/1000
## adjust for other proteomic reagents
cryo=cryo+5
## all commitments
total+sum(c(bz23,kd24,tv24,tvm,iso,dna,lmeta,lmeta2,ma23,ll23,sq,bz25,phood,ee,lab,pt,mot,tele))+ovmatch+cryo
## random and tvm covered by BII and Scialog, iso from IU/JFF
total+
sum(bz23,kd24,tv24,dna,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,pt,mot,sq,tele)+ovmatch+cryo
## DNA possibly covered by IU/other
total+
sum(bz23,kd24,tv24,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,pt,mot,sq,tele)+ovmatch+cryo
## if Powe, JFF, DISC come through
total+
sum(bz23,kd24,tv24,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,sq,tele)+ovmatch+cryo
## if HFSP comes through, back-charge a200, nix part of lmeta
total+
sum(bz23,kd24,tv24,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,tele)+(40)+abs(lmeta2/2)
## all commitments
total+sum(c(bz23,kd24,tv24,tvm,iso,dna,lmeta,lmeta2,ma23,ll23,sq,bz25,phood,ee,lab,pt,mot,tele))+ovmatch+cryo
49-(gra*12/1000)
## random and tvm covered by BII and Scialog, iso from IU/JFF
total+
sum(bz23,kd24,tv24,dna,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,pt,mot,sq,tele)+ovmatch+cryo
## random and tvm covered by BII and Scialog, iso from IU/JFF
total+
sum(bz23,kd24,tv24,dna,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,pt,mot,sq,tele)+ovmatch+cryo-(gra*12/1000)
kd24
tv24
tvm
iso
lmeta
lmeta2
ll23
sq
## clean environment & plots
rm(list=ls())
graphics.off()
## GRA
gra=3363
## startup as of 02 2023
total=183
bz23=-4 ## remaining Belize 2023
kd24=-round(3*gra/1000,0) ## kristin covered Fall 2023 through Summer 2024, Fall 2024 3 months needed / 2 covered
tv24=-round(5*gra/1000,0) ## taylor 2024
pt=-4.4 ## pit tag cables
mot=-10 ## motus
tvm=-round((4.5*2*300)/1000,0) ## taylor pcr
iso=-round((13.5*100)/1000,0) ## dero iso
dna=-round((600*8)/1000,0) ## extractions
lmeta=-20 ## lauren chapter 2
lmeta2=-abs(lmeta*2) ## lauren belize
ma23=0 ## meagan fall 2023 covered DARPA
ll23=-round(3*gra/1000,0) ## lauren 2 month spring and all summer and fall 23 on DARPA
lab=-10 ## random stuff
sq=-(4.5*2*500)/1000 ## sanger
bz25=-10.5
phood=-4
ee=-(2350-1500)/1000
tele=2
## gain back from Match
ovmatch=13657/1000
## adjust match by ecoimm reagents
ovmatch=ovmatch-2.5
## nsf charges
cryo=(2988)/1000
## adjust for other proteomic reagents
cryo=cryo+5
## all commitments
total+sum(c(bz23,kd24,tv24,tvm,iso,dna,lmeta,lmeta2,ma23,ll23,sq,bz25,phood,ee,lab,pt,mot,tele))+ovmatch+cryo
## random and tvm covered by BII and Scialog, iso from IU/JFF
total+
sum(bz23,kd24,tv24,dna,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,pt,mot,sq,tele)+ovmatch+cryo
## random and tvm covered by BII and Scialog, iso from IU/JFF
total+
sum(bz23,kd24,tv24,dna,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,pt,mot,sq,tele)+ovmatch+cryo-(gra*12/1000)
bz25
## iu remainder
iu=2648/1000
## gain back from Match
ovmatch=13657/1000
## adjust match by ecoimm reagents
ovmatch=ovmatch-2.5
## nsf charges
cryo=(2988)/1000
## adjust for other proteomic reagents
cryo=cryo+5
## all commitments
total+sum(c(bz23,kd24,tv24,tvm,iso,dna,lmeta,lmeta2,ma23,ll23,sq,bz25,phood,ee,lab,pt,mot,tele))+ovmatch+cryo
## all commitments
total+sum(c(bz23,kd24,tv24,tvm,iso,dna,lmeta,lmeta2,ma23,ll23,sq,bz25,phood,ee,lab,pt,mot,tele))+ovmatch+cryo+iu
## random and tvm covered by BII and Scialog, iso from IU/JFF
total+
sum(bz23,kd24,tv24,dna,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,pt,mot,sq,tele)+ovmatch+cryo+iu
## DNA possibly covered by IU/other
total+
sum(bz23,kd24,tv24,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,pt,mot,sq,tele)+ovmatch+cryo+iu
## if Powe, JFF, DISC come through
total+
sum(bz23,kd24,tv24,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,sq,tele)+ovmatch+cryo+iu
## if HFSP comes through, back-charge a200, nix part of lmeta
total+
sum(bz23,kd24,tv24,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,tele)+(40)+abs(lmeta2/2)+iu
## clean environment & plots
rm(list=ls())
graphics.off()
## GRA
gra=3363
## startup as of 02 2023
total=183
bz23=-4 ## remaining Belize 2023
kd24=-round(3*gra/1000,0) ## kristin covered Fall 2023 through Summer 2024, Fall 2024 3 months needed / 2 covered
tv24=-round(5*gra/1000,0) ## taylor 2024
pt=-4.4 ## pit tag cables
mot=-10 ## motus
tvm=-round((4.5*2*300)/1000,0) ## taylor pcr
iso=-round((13.5*100)/1000,0) ## dero iso
dna=-round((600*8)/1000,0) ## extractions
lmeta=-20 ## lauren chapter 2
lmeta2=-abs(lmeta*2) ## lauren belize
ma23=0 ## meagan fall 2023 covered DARPA
ll23=-round(3*gra/1000,0) ## lauren 2 month spring and all summer and fall 23 on DARPA
lab=-10 ## random stuff
sq=-(4.5*2*500)/1000 ## sanger
bz25=-10.5
phood=-4
ee=-(2350-1500)/1000
tele=2
## iu remainder
iu=2648/1000
## gain back from Match
ovmatch=13657/1000
## adjust match by ecoimm reagents
ovmatch=ovmatch-2.5
## nsf charges
cryo=(2988)/1000
## adjust for other proteomic reagents
cryo=cryo+5
## jff22
jff22=6900/1000
iso=-round((13.5*200)/1000,0) ## dero iso
iso=-round((13.5*400)/1000,0) ## dero iso
dna=-round((600*8)/1000,0) ## extractions
lmeta=-20 ## lauren chapter 2
lmeta2=-abs(lmeta*2) ## lauren belize
ma23=0 ## meagan fall 2023 covered DARPA
ll23=-round(3*gra/1000,0) ## lauren 2 month spring and all summer and fall 23 on DARPA
lab=-10 ## random stuff
sq=-(4.5*2*500)/1000 ## sanger
bz25=-10.5
phood=-4
ee=-(2350-1500)/1000
tele=2
## iu remainder
iu=2648/1000
## ngs remainder
ngs=3.5
## gain back from Match
ovmatch=13657/1000
## adjust match by ecoimm reagents
ovmatch=ovmatch-2.5
## nsf charges
cryo=(2988)/1000
## adjust for other proteomic reagents
cryo=cryo+5
## jff22
jff22=6900/1000
## random and tvm covered by BII and Scialog, iso from IU/JFF
total+
sum(bz23,kd24,tv24,dna,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,pt,mot,sq,tele,iso)+ovmatch+cryo+iu+jff
## random and tvm covered by BII and Scialog, iso from IU/JFF
total+
sum(bz23,kd24,tv24,dna,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,pt,mot,sq,tele,iso)+ovmatch+cryo+iu+jff22
68-(gra*12/1000)
## random and tvm covered by BII and Scialog, iso from IU/JFF
total+
sum(bz23,kd24,tv24,dna,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,pt,mot,sq,tele,iso)+ovmatch+cryo+iu+jff22+ngs
## DNA possibly covered by IU/other
total+
sum(bz23,kd24,tv24,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,pt,mot,sq,tele,iso)+ovmatch+cryo+iu+jff+ngs
## DNA possibly covered by IU/other
total+
sum(bz23,kd24,tv24,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,pt,mot,sq,tele,iso)+ovmatch+cryo+iu+jff22+ngs
## if Powe, JFF, DISC come through
total+
sum(bz23,kd24,tv24,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,sq,tele,iso)+ovmatch+cryo+iu+jff22+ngs
## DNA possibly covered by IU/other
total+
sum(bz23,kd24,tv24,lmeta,lmeta2,ma23,ll23,bz25,phood,ee,pt,mot,sq,tele,iso)+ovmatch+cryo+iu+jff22+ngs
76-(gra*12/1000)
length(559:584)
## clean environment & plots
rm(list=ls())
graphics.off()
## packages
library(tidyverse)
library(plyr)
library(ggplot2)
library(ape)
install.packages("ape")
install.packages("ape")
install.packages("ape")
## clean environment & plots
rm(list=ls())
graphics.off()
## packages
library(tidyverse)
library(plyr)
library(ggplot2)
library(ape)
library(caper)
library(treeio)
library(ggtree)
library(car)
library(phylofactor)
library(phytools)
remotes::install_github("liamrevell/phytools")
remotes::install_github("liamrevell/phytools")
## clean environment & plots
rm(list=ls())
graphics.off()
## packages
library(tidyverse)
library(plyr)
library(ggplot2)
library(ape)
library(caper)
library(treeio)
library(ggtree)
library(car)
library(phylofactor)
library(phytools)
gc()
sum(c(1,2,1,1,1))
## clean environment & plots
rm(list=ls())
graphics.off()
gc()
## libraries
library(readxl)
## read in edgelist
setwd("~/Desktop/urbmigmalavi/flat files")
edge=read.csv("MalAvi edgelist.csv")
data=edge
## collapse into host data
lset=list()
for(i in 1:length(unique(data$tip))){
## subset
set=data[data$tip%in%unique(data$tip)[i],]
## collapse lineage
nset=data.frame(tip=unique(data$tip)[i],
lineages=paste(set$Lineage_Name,collapse=", "),
alt_lineages=paste(set$Alt_Lineage_Name[!is.na(set$Alt_Lineage_Name)],collapse=", "))
lset[[i]]=nset
}
## collapse
data=do.call(rbind.data.frame,lset)
rm(lset,nset,set,i)
## clean alt
data$alt_lineages=NULL
## load AVONET
setwd("/Users/danielbecker/OneDrive - University of Oklahoma/Becker Lab/Datasets/AVONET")
avonet=read_excel("AVONET Supplementary dataset 1.xlsx",4)
## check name
mis=setdiff(data$tip,avonet$Species3)
## fix label
avonet$tip=avonet$Species3
## merge
data=merge(data,avonet,by="tip",all.x=T)
## Merge in Gonzalez-Lagos et al. 2022 (urban traits)
setwd("/Users/danielbecker/OneDrive - University of Oklahoma/Becker Lab/Datasets/Gonzalez-Lagos et al 2021 Ecography")
gdata=read.csv("DataS1.csv")
## fix
gdata$tip=gsub("_"," ",gdata$animal)
## check name
mis=setdiff(data$tip,gdata$tip)
## fix synonyms
rownames(gdata)=gdata$tip
## Acrocephalus baeticatus/Acrocephalus scirpaceus
new=gdata["Acrocephalus scirpaceus",]
new$tip="Acrocephalus baeticatus"
rownames(new)=new$tip
gdata=rbind.data.frame(gdata,new)
## Otus lempiji/Otus bakkamoena
new=gdata["Otus bakkamoena",]
new$tip="Otus lempiji"
rownames(new)=new$tip
gdata=rbind.data.frame(gdata,new)
## Otus lettia/Otus bakkamoena
new=gdata["Otus bakkamoena",]
new$tip="Otus lettia"
rownames(new)=new$tip
gdata=rbind.data.frame(gdata,new)
## Parus caeruleus/Parus teneriffae
new=gdata["Parus caeruleus",]
new$tip="Parus teneriffae"
rownames(new)=new$tip
gdata=rbind.data.frame(gdata,new)
## Turdus nigriceps/Turdus subalaris
new=gdata["Turdus nigriceps",]
new$tip="Turdus subalaris"
rownames(new)=new$tip
gdata=rbind.data.frame(gdata,new)
## Poospiza nigrorufa/Poospiza whitii
new=gdata["Poospiza nigrorufa",]
new$tip="Poospiza whitii"
rownames(new)=new$tip
gdata=rbind.data.frame(gdata,new)
## Momotus aequatorialis/Momotus momota
new=gdata["Momotus momota",]
new$tip="Momotus aequatorialis"
rownames(new)=new$tip
gdata=rbind.data.frame(gdata,new)
## Nectarinia ludovicensis/Cinnyris ludovicensis
new=gdata["Cinnyris ludovicensis",]
new$tip="Nectarinia ludovicensis"
rownames(new)=new$tip
gdata=rbind.data.frame(gdata,new)
## check name
mis=setdiff(data$tip,gdata$tip)
## clean trait data
gdata=gdata[c("tip","urban","humanDisturbed")]
## merge
data=merge(data,gdata,by="tip",all.x=T)
rm(gdata,avonet,mis,new)
## as factor
data$urban=factor(data$urban)
data$humanDisturbed=factor(data$humanDisturbed)
data$Migration=factor(data$Migration)
length(unique(data$lineages))
## get haplotypes
data$lineages
## get haplotypes
strsplit(data$lineages,", ")
## get haplotypes
sapply(strsplit(data$lineages,", "),unique)
## get haplotypes
unique(sapply(strsplit(data$lineages,", "),unique))
## get haplotypes
x=strsplit(data$lineages,", ")
x
melt(x)
library(reshape2)
melt(x)
library(reshape2)
hdata=melt(x)
## get haplotypes
x=strsplit(data$lineages,", ")
hdata=melt(x)
ldata=data.frame(Lineage_Name=sort(unique(ldata$Lineage_Name)))
hdata=data.frame(Lineage_Name=sort(unique(hdata$Lineage_Name)))
## get haplotypes
x=strsplit(data$lineages,", ")
hdata=melt(x)
hdata$L1
hdata$value
hdata=data.frame(Lineage_Name=sort(unique(hdata$value)))
